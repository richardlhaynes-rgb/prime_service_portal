<div class="group relative bg-white dark:bg-gray-800 rounded-l-md rounded-r-lg shadow-sm hover:shadow-md border border-gray-200 dark:border-gray-700 cursor-pointer transition-all duration-200 overflow-hidden kanban-card"
     data-ticket-id="{{ ticket.id }}"
     hx-get="{% url 'ticket_quick_view' ticket.id %}" 
     hx-target="#drawer-content" 
     hx-swap="innerHTML"
     onclick="openDrawer()">

    <div class="absolute left-0 top-0 bottom-0 w-1.5 
        {% if 'Critical' in ticket.priority %}bg-red-500 shadow-[0_0_8px_rgba(239,68,68,0.6)]
        {% elif 'High' in ticket.priority %}bg-orange-500
        {% elif 'Medium' in ticket.priority %}bg-blue-500
        {% else %}bg-gray-400{% endif %}">
    </div>

    <div class="p-3 pl-5"> 
        
        <div class="flex justify-between items-start mb-2">
            <div class="flex flex-col w-full pr-2">
                <div class="flex justify-between items-center w-full mb-0.5">
                    <span class="text-[10px] font-mono text-gray-400">#{{ ticket.id }}</span>
                    <span class="text-[10px] font-semibold px-1.5 py-0.5 rounded border 
                        {% if 'Critical' in ticket.priority %}text-red-600 bg-red-50 border-red-100 dark:bg-red-900/20 dark:border-red-800 dark:text-red-300
                        {% else %}text-gray-500 bg-gray-50 border-gray-100 dark:bg-gray-700/50 dark:border-gray-600 dark:text-gray-400{% endif %}">
                        {{ ticket.created_at|timesince }} ago
                    </span>
                </div>
                <h4 class="text-sm font-bold text-gray-800 dark:text-gray-100 leading-tight line-clamp-2 group-hover:text-prime-orange transition-colors">
                    {{ ticket.title }}
                </h4>
            </div>
        </div>

        <div class="flex items-center justify-between mt-3 border-t border-gray-100 dark:border-gray-700 pt-2">
            
            <div class="flex items-center gap-2">
                <div class="p-1.5 rounded-md bg-gray-100 dark:bg-gray-700 text-gray-500 dark:text-gray-400">
                    {% if 'Hardware' in ticket.ticket_type %}
                        <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path></svg>
                    {% elif 'Email' in ticket.ticket_type %}
                        <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path></svg>
                    {% elif 'Printer' in ticket.ticket_type %}
                        <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"></path></svg>
                    {% elif 'Software' in ticket.ticket_type or 'Application' in ticket.ticket_type %}
                        <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 10l-2 1m0 0l-2-1m2 1v2.5M20 7l-2 1m2-1l-2-1m2 1v2.5M14 4l-2-1-2 1M4 7l2-1M4 7l2 1M4 7v2.5M12 21l-2-1m2 1l2-1m-2 1v-2.5M6 18l-2-1v-2.5M18 18l2-1v-2.5"></path></svg>
                    {% else %}
                        <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 10h.01M11 15h2M11 7h5c.552 0 1 .448 1 1v11c0 .552-.448 1-1 1H5a1 1 0 01-1-1V8c0-.552.448-1 1-1h5z"></path></svg>
                    {% endif %}
                </div>
                
                <div class="flex flex-col">
                    <span class="text-xs font-medium text-gray-700 dark:text-gray-300">
                        {{ ticket.submitter.first_name }} {{ ticket.submitter.last_name|slice:":1" }}.
                    </span>
                    {% if "Chief" in ticket.submitter.profile.title or "Director" in ticket.submitter.profile.title or "President" in ticket.submitter.profile.title %}
                    <span class="text-[9px] text-yellow-600 bg-yellow-50 dark:bg-yellow-900/30 px-1 rounded flex items-center gap-1 w-fit mt-0.5">
                        <svg class="w-2 h-2" fill="currentColor" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/></svg>
                        VIP
                    </span>
                    {% endif %}
                </div>
            </div>

            <div class="relative">
                {% if ticket.technician %}
                    <div class="absolute -inset-0.5 rounded-full blur-[1px] opacity-75
                        {% if 'Critical' in ticket.priority %}bg-red-500
                        {% elif 'High' in ticket.priority %}bg-orange-500
                        {% elif 'Medium' in ticket.priority %}bg-blue-500
                        {% else %}bg-gray-400{% endif %}">
                    </div>
                    
                    <img class="relative h-8 w-8 rounded-full border-2 border-white dark:border-gray-800 object-cover object-top" 
                         src="{% if ticket.technician.profile.avatar %}{{ ticket.technician.profile.avatar.url }}{% else %}https://ui-avatars.com/api/?name={{ ticket.technician.first_name }}+{{ ticket.technician.last_name }}&background=0D8ABC&color=fff{% endif %}" 
                         alt="{{ ticket.technician.username }}"
                         title="Assigned: {{ ticket.technician.get_full_name }}">
                {% else %}
                    <div class="h-8 w-8 rounded-full border-2 border-dashed border-gray-300 dark:border-gray-600 flex items-center justify-center text-gray-400 text-[10px] bg-white dark:bg-gray-800">
                        ?
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>